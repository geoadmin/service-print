From 97de606ae4e721ac4dae2a473c4d08a8ef2498fd Mon Sep 17 00:00:00 2001
From: Marc Monnerat <procrastinatio@gmail.com>
Date: Fri, 2 Jun 2017 17:29:11 +0200
Subject: [PATCH 1/1] do not recycle connection


Signed-off-by: Marc Monnerat <procrastinatio@gmail.com>
---
 src/main/java/org/mapfish/print/PDFUtils.java |    8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/src/main/java/org/mapfish/print/PDFUtils.java b/src/main/java/org/mapfish/print/PDFUtils.java
index 62aa290..65fc5f1 100644
--- a/src/main/java/org/mapfish/print/PDFUtils.java
+++ b/src/main/java/org/mapfish/print/PDFUtils.java
@@ -70,6 +70,7 @@ import org.mapfish.print.config.layout.TableConfig;
 import java.util.regex.Pattern;
 import org.mapfish.print.utils.PJsonObject;
 import org.w3c.dom.svg.SVGDocument;
+import org.apache.commons.httpclient.HttpClient;
 
 /**
  * Some utility functions for iText.
@@ -186,6 +187,7 @@ public class PDFUtils {
             throws
             IOException, DocumentException {
         File uriAsFile = null;
+        HttpClient client = new HttpClient();
         try {
             uriAsFile = new File(uri.toString());
         } catch (Throwable t) {
@@ -264,7 +266,11 @@ public class PDFUtils {
                             getMethod.setRequestHeader(entry.getKey(), entry.getValue());
                         }
                         if (LOGGER.isDebugEnabled()) LOGGER.debug("loading image: " + uri);
-                        context.getConfig().getHttpClient(uri).executeMethod(getMethod);
+                        //HttpClient client = new HttpClient();
+                        client.executeMethod(getMethod);
+                        // context.getConfig().getHttpClient(uri).executeMethod(getMethod);
+                         
+                        
                         statusCode = getMethod.getStatusCode();
                         statusText = getMethod.getStatusText();
 
-- 
1.7.10.4

